GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/28/12 12:14:08 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


       
       
      Here is a "MAP" of the EBT (coal, fuelgas, oil, refined oil, natural gas, 
      electricity and heat, other energy)
       
       
       
                 PROD    DX       X      DRC     RC     COAL     FG     OIL     
       ROIL     NG     ELEH    OTHE
       
              ------------------------------------------------------------------
      ------------------------------
      BEJ     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
      ...
              ------------------------------------------------------------------
      ------------------------------
      XIN     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
       
                 AGR     IND     CON     TR     WRHR    OTH      FU       INV
              ------------------------------------------------------------------
      ------------------------------
      BEJ     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
      ...
              ------------------------------------------------------------------
      ------------------------------
      XIN     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
       
      We need rebalance EBT in order to:
      a) All the data is consitent with the national EBT (0401.xls)
      b) SUM(DX)=SUM(DRC)
       
      After the rebalancing work, we can estimate detailed industry energy consu
      mption of each province.
       
GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/28/12 12:14:08 Page 2
Read a single state file
C o m p i l a t i o n


  35   
  39   
  40  *SAM table
  41  set     e       energy product  /
  42           coal    Coal,
  43           fg      Fuel gas,
  44           oil     Crude oil,
  45           roil    Refined oil,
  46           ng      Natural gas,
  47           eleh    Electricity & heat,
  48           othe    Other energy/;
  49  set     indi    egy-intensive sectors    /
  50           COAL,
  51           OIL,
  52           MM,
  53           NM,
  54           FBT,
  55           TXT,
  56           CLO,
  57           LOG,
  58           PAP,
  59           ROIL,
  60           CHE,
  61           NMP,
  62           MSP,
  63           MP,
  64           GSM,
  65           TME,
  66           EME,
  67           CCE,
  68           IM,
  69           AC,
  70           WAS,
  71           ELEH,
  72           FG,
  73           WT/;
  74  set     i       accounts /
  75           PROD    Production,
  76           DX      Domestic outflow,
  77           X       Export,
  78           DRC     Domestic inflow,
  79           RC      Import,
  80           COALT   Coal converted from other energy product,
  81           FGT     Fuel gas converted from other energy product,
  82           OILT   Crude oil converted from other energy product,
  83           ROILT   Refined oil converted from other energy product,
  84           NGT     Natural gas converted from other energy productconverted 
      from other energy product,
  85           ELEHT   Electricity & heat converted from other energy product,
  86           OTHET   Other energy converted from other energy product,
  87           AGR     Agriculture,
  88           IND     Industry,
  89           CON     Construction,
  90           TR      Transportation,
  91           WRHR    Wholesale & retail, hotel & restraurant,
  92           OTH     Other service industry,
  93           FU      Final use,
  94           INV     Inventory change/;
  95   
  96  set      r China provinces       /BEJ,TAJ,HEB,SHX,NMG,LIA,JIL,HLJ,SHH,JSU,
      ZHJ,ANH,FUJ,JXI,SHD,HEN,HUB,HUN,GUD,GXI,HAI,CHQ,SIC,GZH,YUN,SHA,GAN,NXA,QI
      H,XIN/;
  97  parameter egyprod(r,i)           prov ebt
  98  parameter ind(*,indi,e)           egy cons of egy by intensive ind
  99  parameter indprov(*,r,e)       egy cons of egy product by province
 100   
GDXIN   C:\Users\DaZHANG\data\ChinaBalancedSAM\data\gdx\egygdx\coal.gdx
 103  $load coal
****           $140
**** LINE    107 INPUT       C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalan
                             ce.gms
 104  display egyprod
****                $141
**** LINE    108 INPUT       C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalan
                             ce.gms
 105   
      set     negval2(r,i,j)     Flag for negative elements;
      set     empty2(r,i,*)      Flag for empty rows and columns;
      parameter       chksam2(r,i,*)       Consistency check of social accounts;
       
      *SAM15
      loop(r,
       
      loop(ri$((ord(ri) le 27)),
      loop(ni$(ord(ni)=ord(ri)),
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,ni,nj)=sam(r,ri,rj);
      );
      );
      );
      );
       
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,"28",nj)=sam(r,"30",rj);
      );
      );
       
       
      *AGGREGATION OF OTH PRODUCTION(other service industry)
      loop(ri$(((ord(ri) ge 31) and (ord(ri) le 42)) or (ord(ri) = 28) or (ord(r
      i) = 29)),
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,"29",nj)=sam15(r,"29",nj)+sam(r,ri,rj);
      );
      );
      );
       
      loop(ri$((ord(ri) ge 43) and (ord(ri) le 69)),
      loop(ni$(ord(ni)=ord(ri)-12),
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,ni,nj)=sam(r,ri,rj);
      );
      );
      );
      );
       
       
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,"58",nj)=sam(r,"72",rj);
      );
      );
       
      *AGGREGATION OF OTH COMMODITIES(other service industry)
      loop(ri$(((ord(ri) ge 73) and (ord(ri) le 84)) or (ord(ri) = 70) or (ord(r
      i) = 71)),
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,"59",nj)=sam15(r,"59",nj)+sam(r,ri,rj);
      );
      );
      );
       
      loop(ri$((ord(ri) ge 85) and (ord(ri) le 96)),
      loop(ni$(ord(ni)=ord(ri)-24),
      loop(rj,
      loop(nj$(ord(nj)=ord(rj)),
      sam15(r,ni,nj)=sam(r,ri,rj);
      );
      );
      );
      );
      *end of loop r
      );
       
       
       
       
      *SAM2
       
       
      loop(r,
       
      loop(nj$(ord(nj) le 27),
      loop(j$(ord(j)=ord(nj)),
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,j)=sam15(r,ni,nj);
      );
      );
      );
      );
       
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,"28")=sam15(r,ni,"30");
      );
      );
       
       
      *AGGREGATION OF OTH PRODUCTION(other service industry)
      loop(nj$(((ord(nj) ge 31) and (ord(nj) le 42)) or (ord(nj) = 28) or (ord(n
      j) = 29)),
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,"29")=sam2(r,i,"29")+sam15(r,ni,nj);
      );
      );
      );
       
      loop(nj$((ord(nj) ge 43) and (ord(nj) le 69)),
      loop(j$(ord(j)=ord(nj)-12),
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,j)=sam15(r,ni,nj);
      );
      );
      );
      );
       
       
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,"58")=sam15(r,ni,"72");
      );
      );
       
      *AGGREGATION OF OTH COMMODITIES(other service industry)
      loop(nj$(((ord(nj) ge 73) and (ord(nj) le 84)) or (ord(nj) = 70) or (ord(n
      j) = 71)),
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,"59")=sam2(r,i,"59")+sam15(r,ni,nj);
      );
      );
      );
       
      loop(nj$((ord(nj) ge 85) and (ord(nj) le 96)),
      loop(j$(ord(j)=ord(nj)-24),
      loop(ni,
      loop(i$(ord(i)=ord(ni)),
      sam2(r,i,j)=sam15(r,ni,nj);
      );
      );
      );
      );
      *end of loop r
      );
       
       
       
       
       
      loop(r,
      negval2(r,i,j) = yes$(sam2(r,i,j) < 0);
       
      empty2(r,i,"row") = 1$(sum(j, sam2(r,i,j)) = 0);
      empty2(r,j,"col") = 1$(sum(i, sam2(r,i,j)) = 0);
       
      chksam2(r,i,"before") = sum(j, sam2(r,i,j)-sam2(r,j,i));
      chksam2(r,i,"scale") = sum(j, sam2(r,j,i));
      chksam2(r,i,"%dev")$sum(j, sam2(r,i,j)) = 100 * sum(j, sam2(r,i,j)-sam2(r,
      j,i)) / sum(j, sam2(r,i,j));
       
      );
 266   
 267   
GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/28/12 12:14:08 Page 3
Read a single state file
Error Messages


140  Unknown symbol
141  Symbol neither initialized nor assigned
        A wild shot: You may have spurious commas in the explanatory
        text of a declaration. Check symbol reference list.

**** 2 ERROR(S)   0 WARNING(S)
GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/28/12 12:14:08 Page 4
Read a single state file
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \egydatabalance.gms
     2      101 IF EXIST       1     101  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \data\gdx\egygdx\coal.gdx
     3      102 GDXIN          1     106  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \data\gdx\egygdx\coal.gdx


COMPILATION TIME     =        0.031 SECONDS      3 Mb  WIN234-234 May 21, 2010


USER: Matt Mowers                                    G100419:1834CP-WIN
      National Renewable Energy Laboratory (NREL)                DC8246


**** FILE SUMMARY

Input      C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalance.gms
Output     C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalance.lst

**** USER ERROR(S) ENCOUNTERED
