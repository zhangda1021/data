GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/29/12 13:36:14 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


       
       
      Here is a "MAP" of the EBT (coal, fuelgas, oil, refined oil, natural gas, 
      electricity and heat, other energy)
       
       
       
                 PROD    DX       X      DRC     RC     COAL     FG     OIL     
       ROIL     NG     ELEH    OTHE
       
              ------------------------------------------------------------------
      ------------------------------
      BEJ     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
      ...
              ------------------------------------------------------------------
      ------------------------------
      XIN     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
       
                 AGR     IND     CON     TR     WRHR    OTH      FU       INV
              ------------------------------------------------------------------
      ------------------------------
      BEJ     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
      ...
              ------------------------------------------------------------------
      ------------------------------
      XIN     |       |       |       |       |       |       |       |       | 
            |       |       |       |
              ------------------------------------------------------------------
      ------------------------------
       
      We need rebalance EBT in order to:
      a) All the data is consitent with the national EBT (0401.xls)
      b) SUM(DX)=SUM(DRC)
       
      After the rebalancing work, we can estimate detailed industry energy consu
      mption of each province.
       
GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/29/12 13:36:14 Page 2
Read a single state file
C o m p i l a t i o n


  35   
  39   
  40  *SAM table
  41  set     e       energy product  /
  42           coal    Coal,
  43           fg      Fuel gas,
  44           oil     Crude oil,
  45           roil    Refined oil,
  46           ng      Natural gas,
  47           eleh    Electricity & heat,
  48           othe    Other energy/;
  49  set     indi    egy-intensive sectors    /
  50           COAL,
  51           OIL,
  52           MM,
  53           NM,
  54           FBT,
  55           TXT,
  56           CLO,
  57           LOG,
  58           PAP,
  59           ROIL,
  60           CHE,
  61           NMP,
  62           MSP,
  63           MP,
  64           GSM,
  65           TME,
  66           EME,
  67           CCE,
  68           IM,
  69           AC,
  70           WAS,
  71           ELEH,
  72           FG,
  73           WT/;
  74  set     i       accounts /
  75           PROD    Production,
  76           DX      Domestic outflow,
  77           X       Export,
  78           DRC     Domestic inflow,
  79           RC      Import,
  80           COALT   Coal converted from other energy product,
  81           FGT     Fuel gas converted from other energy product,
  82           OILT   Crude oil converted from other energy product,
  83           ROILT   Refined oil converted from other energy product,
  84           NGT     Natural gas converted from other energy productconverted 
      from other energy product,
  85           ELEHT   Electricity & heat converted from other energy product,
  86           OTHET   Other energy converted from other energy product,
  87           AGR     Agriculture,
  88           IND     Industry,
  89           CON     Construction,
  90           TR      Transportation,
  91           WRHR    Wholesale & retail & hotel & restraurant,
  92           OTH     Other service industry,
  93           FU      Final use,
  94           INV     Inventory change/;
  95   
  96  set      r China provinces       /BEJ,TAJ,HEB,SHX,NMG,LIA,JIL,HLJ,SHH,JSU,
      ZHJ,ANH,FUJ,JXI,SHD,HEN,HUB,HUN,GUD,GXI,HAI,CHQ,SIC,GZH,YUN,SHA,GAN,NXA,QI
      H,XIN/;
  97  parameter coal(r,i)           coal ebt
  98  parameter fg(r,i)           fg ebt
  99  parameter oil(r,i)           oil ebt
 100  parameter roil(r,i)           roil ebt
 101  parameter ng(r,i)           ng ebt
 102  parameter eleh(r,i)           eleh ebt
 103  parameter othe(r,i)           othe ebt
 104  parameter coal_bench(i,*)
 105  parameter fg_bench(i,*)
 106  parameter oil_bench(i,*)
 107  parameter roil_bench(i,*)
 108  parameter ng_bench(i,*)
 109  parameter eleh_bench(i,*)
 110  parameter othe_bench(i,*)
 111  parameter ind(*,indi,e)           egy cons of egy by intensive ind
 112  parameter indprov(*,r,e)       egy cons of egy product by province
 113   
GDXIN   C:\Users\DaZHANG\data\ChinaBalancedSAM\data\gdx\egygdx\coal.gdx
--- LOAD  coal = 1:coal
 117  display coal
GDXIN   C:\Users\DaZHANG\data\ChinaBalancedSAM\data\gdx\egygdx\coal_bench.gdx
--- LOAD  coal_bench = 1:coal_bench
 120  display coal_bench
 121   
 122  variables       x(r,i)  adjusted value
 123  variable        j       obj function
 124   
 125  Equations  criterion criterion definition
 126             bench   benchmark egy
 127             balance_coal  input output balance
 128             balance_fg
 129             balance_oil
 130             balance_roil
 131             balance_ng
 132             balance_eleh
 133             balance_othe
 134             trade   domestic trade balance
 135             sign    no sign change;
 136   
 137   
 138  criterion..
 139  j=e=sum((r,i),sqr(x(r,i)-coal(r,i)));
 140  *j=e=sum((r,i)$%egyprod%(r,i),x(r,i)*(log(x(r,i)/%egyprod%(r,i))-1));
 141   
 142   
 143  *No bench for dx and drc
 144  bench(i)$((ord(i)<>2) and (ord(i)<>4))..
 145  sum(r,x(r,i)) =e= coal_bench(i,"value");
 146  *coal
 147  balance_coal(r)$(sameas('coal','COAL'))..
 148  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"COALT"))=e=sum(i,x(r,i));
 149   
 150  *fg
 151  balance_fg(r)$(sameas('coal','FG'))..
 152  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"FGT"))=e=sum(i,x(r,i));
 153  *oil
 154  balance_oil(r)$(sameas('coal','OIL'))..
 155  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"OILT"))=e=sum(i,x(r,i));
 156  *roil
 157  balance_roil(r)$(sameas('coal','ROIL'))..
 158  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"ROILT"))=e=sum(i,x(r,i));
 159  *ng
 160  balance_ng(r)$(sameas('coal','NG'))..
 161  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"NGT"))=e=sum(i,x(r,i));
 162  *eleh
 163  balance_eleh(r)$(sameas('coal','ELEH'))..
 164  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"ELEHT"))=e=sum(i,x(r,i));
 165  *othe
 166  balance_othe(r)$(sameas('coal','OTHE'))..
 167  2*(x(r,"PROD")+x(r,"RC")+x(r,"DRC")+x(r,"OTHET"))=e=sum(i,x(r,i));
 168   
 169  trade..
 170  sum(r,x(r,"DX"))=e=sum(r,x(r,"DRC"));
 171   
 172   
 173  sign(r,i)$((ord(i)<>2) and (ord(i)<>4))..
 174  x(r,i)*coal(r,i)=ge=0;
****                    $140,37,409
**** LINE    178 INPUT       C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalan
                             ce.gms
 175   
 176  Model gua /all/;
 177  x.l(r,i)= coal(r,i);
 178  gua.iterlim=1000;
 179  Solve gua minimizing j using nlp;
****                                  $257
**** LINE    183 INPUT       C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalan
                             ce.gms
 180   
 181  Display x.l;
 182   
 183   
GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/29/12 13:36:14 Page 3
Read a single state file
Error Messages


 37  '=l=' or '=e=' or '=g=' operator expected
140  Unknown symbol
257  Solve statement not checked because of previous errors
409  Unrecognizable item - skip to find a new statement
       looking for a ';' or a key word to get started again

**** 4 ERROR(S)   0 WARNING(S)
GAMS Rev 234  WIN-VS8 23.4.3 x86/MS Windows             02/29/12 13:36:14 Page 4
Read a single state file
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \egydatabalance.gms
     2      114 IF EXIST       1     114  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \data\gdx\egygdx\coal.gdx
     3      115 GDXIN          1     119  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \data\gdx\egygdx\coal.gdx
     4      118 GDXIN          1     122  C:\Users\DaZHANG\data\ChinaBalancedSAM
                                          \data\gdx\egygdx\coal_bench.gdx


COMPILATION TIME     =        0.062 SECONDS      3 Mb  WIN234-234 May 21, 2010


USER: Matt Mowers                                    G100419:1834CP-WIN
      National Renewable Energy Laboratory (NREL)                DC8246


**** FILE SUMMARY

Input      C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalance.gms
Output     C:\Users\DaZHANG\data\ChinaBalancedSAM\egydatabalance.lst

**** USER ERROR(S) ENCOUNTERED
