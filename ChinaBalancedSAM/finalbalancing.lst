GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows          03/13/12 14:55:07 Page 1
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
C o m p i l a t i o n


       
              Production activities   A (30)
              Commodities             C (30)
              Primary Factors         F (2)
              Households              H (1)
              Central Government      G1(1)
              Provincial Government   G2(1)
              Types of taxes          T (4)
              Rest of country         DX(1)
              Rest of world           X (1)
              Investment-savings      I (2)
       
      Here is a "MAP" of the SAM with the names of the submatrices which
      contain data.  All cells with no labels are empty:
       
       
       
                 A       C        F       H      G1      G2       T       DX    
        X      I1      I2
              ------------------------------------------------------------------
      ----------------------
      A       |       |   ac  |       |       |       |       |   sa  |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      C       |   ca  |       |       |   ch  |       |  g2d  |       |   der | 
        er  |  cs1  |  cs2  |
              ------------------------------------------------------------------
      ----------------------
      F       |   fa  |       |       |       |       |       |       |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      H       |       |       |   hf  |       |       |  hg2  |       |   dhr | 
        hr  |       |       |
              ------------------------------------------------------------------
      ----------------------
      G1      |       |       |       |       |       |  g1g2 |       |       | 
            |  cg1s |       |
              ------------------------------------------------------------------
      ----------------------
      G2      |       |       |       |       | g2g1  |       |   tr  |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      T       |   ta  |       |       |       |       |       |       |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      DX      |       |  drc  |       |  drh  |       |       |       |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      X       |       |   rc  |       |   rh  |       |       |       |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      I1      |       |       |   dp  |  psv1 | g1sv  |       |       |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
      I2      |       |   ic  |       |  psv2 |       |       |       |       | 
            |       |       |
              ------------------------------------------------------------------
      ----------------------
       
  48   
  49  *SAM table
  50  set     i   SAM rows and colums indices   /
  51          1*30    Industries,
  52          31*60   Commodities,
  53          61      Labor,
  54          62      Capital,
  55          63      Household,
  56          64      Central Government,
  57          65      Local Government,
  58          66      Production tax,
  59          67      Commodity tax,
  60          68      Factor tax,
  61          69      Income tax,
  62          70      Domestic trade,
  63          71      Foreign trade,
  64          72      Investment,
  65          73      Inventory/;
  66  alias (i,j,ii);
  67  *Energy balance table
  68  set ebti /
  69           1       DX,
  70           2       X,
  71           3       DRC,
  72           4       RC,
  73           5       AGR,
  74           6       COAL,
  75           7       OIL,
  76           8       MM,
  77           9       NM,
  78           10      FBT,
  79           11      TXT,
  80           12      CLO,
  81           13      LOG,
  82           14      PAP,
  83           15      ROIL,
  84           16      CHE,
  85           17      NMP,
  86           18      MSP,
  87           19      MP,
  88           20      GSM,
  89           21      TME,
  90           22      EME,
  91           23      CCE,
  92           24      IM,
  93           25      AC,
  94           26      WAS,
  95           27      ELEH,
  96           28      FG,
  97           29      WT,
  98           30      CON,
  99           31      TR,
 100           32      WRHR,
 101           33      OTH,
 102           34      NG,
 103           35      FU,
 104           36      INV,
 105           37      PROD
 106  /;
 107  set      e       energy product  /
 108           coal    Coal,
 109           fg      Fuel gas,
 110           oil     Crude oil,
 111           roil    Refined oil,
 112           ng      Natural gas,
 113           eleh    Electricity & heat,
 114           othe    Other energy/;
 115  set      r China provinces       /BEJ,TAJ,HEB,SHX,NMG,LIA,JIL,HLJ,SHH,JSU,
      ZHJ,ANH,FUJ,JXI,SHD,HEN,HUB,HUN,GUD,GXI,HAI,CHQ,SIC,GZH,YUN,SHA,GAN,NXA,QI
      H,XIN/;
 116  set      prange/
 117           LB,
 118           UB/;
 119  parameter sam3(r,i,j)           SAM v3.0 ready for rebalancing
 120  parameter ebt(e,r,ebti)         EBT
 121  parameter ebt2(i,r,ebti)        EBT for OPT
 122  parameter pricerange(i,prange)  Price range of energy products
 123  parameter oilngratio(r)         Oil and gas ratio of (PROD+DRC+RC-X-DX)
 124  parameter poilng
GDXIN   C:\Users\dzhang\data\ChinaBalancedSAM\/data/gdx/sam3.gdx
--- LOAD  sam3 = 9:sam3
--- LOAD  ebt2 = 30:ebt2
--- LOAD  pricerange = 11:pricerange
 129   
 130   
 131   
 132   
 133  *$ontext
 134  positive variables finalsam (r,i,j)
 135  positive variables rowsum(r,i)
 136  positive variables columnsum(r,i)
 137  positive variables domesticinsum(i)
 138  positive variables domesticoutsum(i)
 139  positive variables p(i,r,j)
 140  variable jj
 141   
 142  Equations
 143          rsum
 144          csum
 145          sumbalance
 146   
 147         price_dx
 148         price_x
 149         price_drc
 150         price_rc
 151         price_inv
 152         price_fu
 153         price_prod
 154         price_sectors
 155   
 156         pricelb
 157   
 158         priceub
 159         obj
 160  ;
 161   
 162   
 163  *rsum(r,i)..
 164  rsum(r,i)$(sameas(r,'BEJ'))..
 165  sum(j,finalsam(r,i,j))=e=rowsum(r,i);
 166   
 167  *csum(r,i)..
 168  csum(r,i)$(sameas(r,'BEJ'))..
 169  sum(j,finalsam(r,j,i))=e=columnsum(r,i);
 170   
 171  *sumbalance(r,i)..
 172  sumbalance(r,i)$(sameas(r,'BEJ'))..
 173  rowsum(r,i)=e=columnsum(r,i);
 174   
 175  *dx
 176  price_dx(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) o
      r (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 177  p(i,r,"1")*ebt2(i,r,"1")=e=finalsam(r,j,"70");
 178  *x
 179  price_x(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) or
       (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 180  p(i,r,"2")*ebt2(i,r,"2")=e=finalsam(r,j,"71");
 181  *drc
 182  price_drc(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) 
      or (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 183  p(i,r,"3")*ebt2(i,r,"3")=e=finalsam(r,"70",j);
 184  *rc
 185  price_rc(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) o
      r (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 186  p(i,r,"4")*ebt2(i,r,"4")=e=finalsam(r,"71",j);
 187  *fu
 188  price_fu(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) o
      r (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 189  p(i,r,"35")*ebt2(i,r,"35")=e=finalsam(r,j,"63")+finalsam(r,j,"65");
 190  *inv
 191  price_inv(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) 
      or (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 192  p(i,r,"36")*ebt2(i,r,"36")=e=finalsam(r,j,"73");
 193  *prod
 194  price_prod(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23)
       or (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30))..
 195  p(i,r,"37")*ebt2(i,r,"37")=e=finalsam(r,i,j);
 196   
 197  *$ontext
 198  *sectors
 199  price_sectors(i,r,j,ebti,ii)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or 
      (ord(i)=23) or (ord(i)=24) or (ord(i)=30)) and (ord(j)=ord(i)+30) and ((or
      d(ebti)>=5) and (ord(ebti)<=34)) and (ord(ii)=ord(ebti)-4))..
 200  p(i,r,ii)*ebt2(i,r,ebti)*finalsam(r,j,ii)-finalsam(r,j,ii)*finalsam(r,j,ii
      )=e=0;
 201  *$offtext
 202   
 203  *lb
 204  pricelb(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) or
       (ord(i)=24) or (ord(i)=30)) and ((ord(j)>=1) and (ord(j)<=37)))..
 205  (p(i,r,j)-pricerange(i,"lb"))=g=0;
 206  *ub
 207  priceub(i,r,j)$(((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) or
       (ord(i)=24) or (ord(i)=30)) and ((ord(j)>=1) and (ord(j)<=37)))..
 208  (p(i,r,j)-pricerange(i,"ub"))=l=0;
 209   
 210  obj..
 211  jj=e=sum(r$(sameas(r,'BEJ')),sum(i,sum(j,sqr(finalsam(r,i,j)-sam3(r,i,j)))
      ));
 212   
 213  Model gua /all/;
 214  loop(r,
 215  loop(i,
 216  loop(j,
 217  finalsam.l(r,i,j)=sam3(r,i,j);
 218  );););
 219  loop(i,
 220  loop(r,
 221  loop(j,
 222  if(sameas(i,"2"),
 223  p("2",r,j).l=500;
****  $143      $36,8,409
 224  );
****  $408
 225  if(sameas(i,"3"),
****             $149
 226  p("3",r,j).l=3000;
****  $143      $36,8,409
 227  );
****  $408
 228  if(sameas(i,"11"),
****             $149
 229  p("11",r,j).l=3000;
****  $143       $36,8,409
 230  );
****  $408
 231  if(sameas(i,"23"),
****             $149
 232  p("23",r,j).l=1000;
****  $143       $36,8,409
 233  );
****  $408
 234  if(sameas(i,"24"),
****             $149
 235  p("24",r,j).l=5000;
****  $143       $36,8,409
 236  );
****  $408
 237  if(sameas(i,"30"),
****             $149
 238  p("30",r,j).l=1000;
****  $143       $36,8,409
 239  );
****  $408
 240  );););
****  $408,408,408
 241  loop(r,
 242  loop(i,
 243  loop(j,
 244  if (sam3(r,i,j)=0,
 245  finalsam.fx(r,i,j)=0;
 246  );
 247  );
 248  );
 249  );
 250  gua.iterlim=100000;
 251  Solve gua minimizing jj using nlp;
****                                   $257
 252  display finalsam.l;
 253   
 254  *chksam
 255  set     negval4(i,j)     Flag for negative elements;
 256  set     empty4(i,*)      Flag for empty rows and columns;
 257  parameter       chksam4(i,*)       Consistency check of social accounts;
 258  parameter totoutput2;
 259  totoutput2=0;
 260  loop(r$(sameas('BEJ',r)),
 261  loop(i$((ord(i)>=31) and (ord(i)<=60)),
 262  totoutput2=totoutput2+sum(j,finalsam.l(r,i,j));
 263  );
 264  );
 265  loop(r$(sameas('BEJ',r)),
 266  negval4(i,j) = yes$(sam3(r,i,j) < 0);
 267  empty4(i,"row") = 1$(sum(j, finalsam.l(r,i,j)) = 0);
 268  empty4(j,"col") = 1$(sum(i, finalsam.l(r,i,j)) = 0);
 269  chksam4(i,"before") = sum(j, finalsam.l(r,i,j)-finalsam.l(r,j,i));
 270  chksam4(i,"scale") = sum(j, finalsam.l(r,j,i));
 271  chksam4(i,"%dev")$sum(j, finalsam.l(r,i,j)) = 100 * sum(j, finalsam.l(r,i,
      j)-finalsam.l(r,j,i)) / sum(j, finalsam.l(r,i,j));
 272  );
 273  parameter sam4(i,j);
 274  loop(r$(sameas('BEJ',r)),
 275  loop(i,
 276  loop(j,
 277  sam4(i,j)= finalsam.l(r,i,j);
 278  );
 279  );
 280  );
 281   
 282  *Energy related data
 283  parameter egyvalue2(i,r,ebti);
 284  loop(r,
 285  loop(i$((ord(i)=2) or (ord(i)=3) or (ord(i)=11) or (ord(i)=23) or (ord(i)=
      24) or (ord(i)=30)),
 286  loop(j$(ord(j)=ord(i)+30),
 287  egyvalue2(i,r,"1")=sam4(j,"70");
 288  egyvalue2(i,r,"2")=sam4(j,"71");
 289  egyvalue2(i,r,"3")=sam4("70",j);
 290  egyvalue2(i,r,"4")=sam4("71",j);
 291  loop(ebti$((ord(ebti)>=5) and (ord(ebti)<=34)),
 292  loop(ii$(ord(ii)=ord(ebti)-4),
 293  egyvalue2(i,r,ebti)=sam4(j,ii);
 294  );
 295  );
 296  egyvalue2(i,r,"35")=sam4(j,"63")+sam4(j,"65");
 297  egyvalue2(i,r,"36")=sam4(j,"73");
 298  egyvalue2(i,r,"37")=sam4(i,j);
 299  );););
 300  display egyvalue2;
 301   
 302   
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows          03/13/12 14:55:07 Page 2
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Error Messages


  8  ')' expected
 36  '=' or '..' or ':=' or '$=' operator expected
     rest of statement ignored
143  A suffix is missing
149  Uncontrolled set entered as constant
257  Solve statement not checked because of previous errors
408  Too many ),] or }
409  Unrecognizable item - skip to find a new statement
       looking for a ';' or a key word to get started again

**** 39 ERROR(S)   0 WARNING(S)
GAMS Rev 232  WEX-WEI 23.2.1 x86_64/MS Windows          03/13/12 14:55:07 Page 3
G e n e r a l   A l g e b r a i c   M o d e l i n g   S y s t e m
Include File Summary


   SEQ   GLOBAL TYPE      PARENT   LOCAL  FILENAME

     1        1 INPUT          0       0  C:\Users\dzhang\data\ChinaBalancedSAM\
                                          finalbalancing.gms
     2      125 GDXIN          1     125  C:\Users\dzhang\data\ChinaBalancedSAM\
                                          /data/gdx/sam3.gdx


COMPILATION TIME     =        0.094 SECONDS      4 Mb  WEX232-232 Aug 11, 2009


USER: Institute of Nuclear and New Energy Technology G101217:1031AV-WIN
      TsingHua Univerrsity                                       DC8455
      License for teaching and research at degree granting institutions


**** FILE SUMMARY

Input      C:\Users\dzhang\data\ChinaBalancedSAM\finalbalancing.gms
Output     C:\Users\dzhang\data\ChinaBalancedSAM\finalbalancing.lst

**** USER ERROR(S) ENCOUNTERED
